webpackJsonp([4],{IvBB:function(e,t){},o8po:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("Gu7T"),i=a.n(l),s=a("Xxa5"),o=a.n(s),n=a("exGp"),r=a.n(n),u=a("K8K1"),c=a("bQLH"),d={name:"productDialog",props:{propGetSkuUrl:"",getDailyReportUrl:"",getMonthlyReportUrl:"",getWeeklyReportUrl:"",propProductSelectShow:{default:!1},propMaxSelect:{default:20}},data:function(){return{productSelectShow:!1,skuListSelectedTemp:[],skuSearchWord:"",skuListTableCurrentPage:1,skuListTableTotalPage:1,skuListTotalRecord:0,skuListTablePageSize:u.a.system.query.pageSize+0,skuListTableLoading:!1,skuListTableInit:!0}},methods:{dialogSkuShowHandle:function(){this.skuListTableInit&&this.dialogSkuGetHandle(this.skuListTablePageFilter,this.inputSearchWordFilter)},dialogSkuGetHandle:function(){var e=r()(o.a.mark(function e(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("dialogSkuGetHandle"),(t=this).dialogSkuSelectShow=!0,t.skuListTableLoading=!0,e.next=6,c.default.statamazonsku(t.propGetSkuUrl,a,l).then(function(e){t.$store.dispatch("updateSkuListData",e.data),e.tp<1&&t.$store.dispatch("updateSkuListData",[]),t.skuListTotalRecord=e.tr?e.tr:0,t.skuListTableTotalPage=e.tp,t.skuListTableLoading=!1}).catch(function(e){t.$message.error(e.message||t.$i18n.t("操作失败")),t.skuListTableLoading=!1});case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),dialogTableCheckSelect:function(e,t,a){console.log(e);this.dialogSkuListTableRowSelectedHandle(this.$refs.multipleTable.selection,e)},dialogSkuListTableSelectionChange:function(e){var t=this;console.log("补勾选sku"),t.totalSelectSkuItems.forEach(function(e){for(var a in t.skuListTable){var l=t.skuListTable[a];console.log(l),e.id==l.id&&(t.$refs.multipleTable.toggleRowSelection(e,!0),t.$refs.multipleTable.toggleRowSelection(l,!0))}})},dialogSkuListTableRowSelectedHandle:function(e,t){var a=this,l=a.skuListSelectedTemp.filter(function(e){return t.id==e.id});if(l.length<1){if(console.log("没有重复就加入",l.length<1,l),!(a.skuListSelectedTemp.length<a.propMaxSelect))return a.$message.warning("可选择的SKU不可超过"+a.propMaxSelect+"个"),a.$refs.multipleTable.toggleRowSelection(t,!1),!1;a.skuListSelectedTemp.push(t),a.$refs.multipleTable.toggleRowSelection(t,!0)}else a.skuListSelectedTemp.splice(a.skuListSelectedTemp.indexOf(t),1),a.$refs.multipleTable.toggleRowSelection(t,!1),console.log("重复了就去掉",l.length>0,l)},dialogSkuSelectCancelHandle:function(){this.$store.dispatch("updateSkuSelectedListData",[]),this.dialogSkuSelectShow=!1},dialogSkuSelectSubmitHandle:function(){var e=this;if(e.totalSelectSkuItems.length>20)return e.$message.warning("选择的SKU超过20个"),!1;e.skuSearchWord="",e.skuListTableCurrentPage=1,e.$store.dispatch("updateSkuSelectedListData",[].concat(i()(e.totalSelectSkuItems))),e.skuListSelectedTemp=[],e.productSelectShow=!1,e.$parent.totalSelectSkuItems=e.totalSelectSkuItems},skuSearchHandle:function(){var e=r()(o.a.mark(function e(t){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(a=this).skuListTableCurrentPage=1,a.dialogSkuGetHandle(a.skuListTablePageFilter,a.inputSearchWordFilter);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),dialogSkuFilterFunc:function(e,t,a){console.log(e,"123")},skuListTablePageChangeHandle:function(e){console.log(e);this.skuListTableCurrentPage=e,this.dialogSkuGetHandle(this.skuListTablePageFilter,this.inputSearchWordFilter)}},computed:{skuListSelected:function(e){return e.$store.getters.getFilterSkuSelectData},skuListData:function(e){return e.$store.getters.getFilterSkuData},chartType:function(){return this.$store.dispatch("updatePageSeries",this.$route.meta.series),this.$route.meta.series},inputSearchWordFilter:function(){var e=[];return this.skuListTableCurrentPage=1,this.skuSearchWord&&e.push([{"sku-ilk":this.skuSearchWord},{"asin-ilk":this.skuSearchWord}]),e},skuListTablePageFilter:function(){return{page:this.skuListTableCurrentPage,size:this.skuListTablePageSize||u.a.system.query.pageSize}},skuListTableFiltered:function(){var e=this;return e.skuSearch?e.skuListTable.filter(function(t){return t.sku.match(new RegExp(e.skuSearch,"i"))}):e.skuListTable},totalSelectSkuItems:function(){var e=this,t=void 0;return t=e.skuListSelectedTemp.filter(function(t){var a=void 0;for(var l in e.skuListSelected){if(1==(a=e.skuListSelected[l].id==t.id))break;a=!1}return!a}),console.log("去重选择列表",t),t.concat(e.skuListSelected)},beforeClose:function(){this.$emit("closeMe",this.productSelectShow)}},watch:{propProductSelectShow:function(e){this.productSelectShow=e}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return"sku"==e.chartType?a("el-dialog",{attrs:{title:"SKU 选择",visible:e.productSelectShow,modal:!0,top:"5vh","append-to-body":!0,"close-on-click-modal":!1,"before-close":e.beforeClose},on:{"update:visible":function(t){e.productSelectShow=t},opened:e.dialogSkuShowHandle}},[a("el-row",{staticStyle:{height:"70vh","z-index":"2048"},attrs:{gutter:24}},[a("el-col",{attrs:{span:14}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"输入SKU或ASIN进行搜索",size:"mini"},model:{value:e.skuSearchWord,callback:function(t){e.skuSearchWord=t},expression:"skuSearchWord"}},[a("el-button",{attrs:{slot:"append",type:"primary",icon:"el-icon-third  el-icon-search"},on:{click:e.skuSearchHandle},slot:"append"})],1)],1),e._v(" "),a("el-col",{attrs:{span:14}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.skuListTableLoading,expression:"skuListTableLoading"}],ref:"multipleTable",staticClass:"compact",staticStyle:{width:"100%","margin-top":".5em","min-height":"400px","max-height":"500px"},attrs:{data:e.skuListData,"max-height":"500","select-on-indeterminate":!1,"header-row-style":{height:"32px"}},on:{select:e.dialogSkuListTableRowSelectedHandle,"row-click":e.dialogTableCheckSelect}},[a("el-table-column",{staticClass:"table-column",attrs:{type:"selection",width:"55"},on:{"filter-method":e.dialogSkuFilterFunc}}),e._v(" "),a("el-table-column",{staticClass:"table-column",attrs:{prop:"sku",label:"SKU"}}),e._v(" "),a("el-table-column",{staticClass:"table-column",attrs:{prop:"asin",label:"ASIN",width:"150"}})],1),e._v(" "),a("el-row",{staticStyle:{margin:"5px 0 0 0"}},[a("el-col",{attrs:{align:"center"}},[a("el-pagination",{attrs:{small:"",background:"",layout:"total, prev, pager, next, jumper","page-count":e.skuListTableTotalPage,"current-page":e.skuListTableCurrentPage},on:{"update:currentPage":function(t){e.skuListTableCurrentPage=t},"update:current-page":function(t){e.skuListTableCurrentPage=t},"current-change":e.skuListTablePageChangeHandle}})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.skuListTableLoading,expression:"skuListTableLoading"}],staticClass:"compact",staticStyle:{width:"100%","margin-top":".5em","min-height":"400px","max-height":"500px"},attrs:{data:e.skuListSelectedTemp,"max-height":"600"}},[a("el-table-column",{attrs:{prop:"sku",label:"Selected SKU"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer",align:"center"},slot:"footer"},[a("el-button",{attrs:{size:"mini"},on:{click:e.dialogSkuSelectCancelHandle}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.dialogSkuSelectSubmitHandle}},[e._v("确 定")])],1)],1):e._e()},staticRenderFns:[]};var S=a("VU/8")(d,p,!1,function(e){a("IvBB")},"data-v-ca188a9a",null);t.default=S.exports}});
//# sourceMappingURL=4.js.map